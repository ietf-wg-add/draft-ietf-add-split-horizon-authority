<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Establishing Local DNS Authority in Validated Split-Horizon Environments</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Dan Wing" name="author">
<meta content="Kevin Smith" name="author">
<meta content="Benjamin Schwartz" name="author">
<meta content="
       When split-horizon DNS is deployed by a network, certain domain names can
      be resolved authoritatively by a network-provided DNS resolver. DNS clients
      that are not configured to use this resolver by default can use it for
      these specific domains only. This specification defines a mechanism for domain owners
      to inform DNS clients about local resolvers that are authorized to answer
      authoritatively for certain subdomains. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="draft-ietf-add-split-horizon-authority-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-add-split-horizon-authority.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Establishing Local DNS Authority</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 22 December 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ADD</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-add-split-horizon-authority-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-06-20" class="published">20 June 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-12-22">22 December 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Citrix</div>
</div>
<div class="author">
      <div class="author-name">K. Smith</div>
<div class="org">Vodafone</div>
</div>
<div class="author">
      <div class="author-name">B. Schwartz</div>
<div class="org">Meta</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Establishing Local DNS Authority in Validated Split-Horizon Environments</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">When split-horizon DNS is deployed by a network, certain domain names can
      be resolved authoritatively by a network-provided DNS resolver. DNS clients
      that are not configured to use this resolver by default can use it for
      these specific domains only. This specification defines a mechanism for domain owners
      to inform DNS clients about local resolvers that are authorized to answer
      authoritatively for certain subdomains.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
          Adaptive DNS Discovery Working Group mailing list (add@ietf.org),
          which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/add/">https://mailarchive.ietf.org/arch/browse/add/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
          <span><a href="https://github.com/ietf-wg-add/draft-ietf-add-split-horizon-authority">https://github.com/ietf-wg-add/draft-ietf-add-split-horizon-authority</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 22 December 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-scope" class="internal xref">Scope</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-requirements" class="internal xref">Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-establishing-local-dns-auth" class="internal xref">Establishing Local DNS Authority</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-conveying-authorization-cla" class="internal xref">Conveying Authorization Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-using-dhcp" class="internal xref">Using DHCP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-using-provisioning-domains" class="internal xref">Using Provisioning Domains</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-validating-authority-over-l" class="internal xref">Validating Authority over Local Domain Hints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-using-a-pre-configured-exte" class="internal xref">Using a Pre-configured External Resolver</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-using-dnssec" class="internal xref">Using DNSSEC</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-delegating-dnssec-across-sp" class="internal xref">Delegating DNSSEC across Split DNS Boundaries</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-examples-of-split-horizon-d" class="internal xref">Examples of Split-Horizon DNS Configuration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-split-horizon-entire-zone" class="internal xref">Split-Horizon Entire Zone</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-verification-using-an-exter" class="internal xref">Verification Using an External Resolver</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-verification-using-dnssec" class="internal xref">Verification using DNSSEC</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-operational-efficiency-in-s" class="internal xref">Operational Efficiency in Split-Horizon Deployments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-validation-with-ikev2" class="internal xref">Validation with IKEv2</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-authorization-claim-update" class="internal xref">Authorization Claim Update</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-dhcp-split-dns-authenticati" class="internal xref">DHCP Split DNS Authentication Algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-provisioning-domains-split-" class="internal xref">Provisioning Domains Split DNS Additional Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-new-pvd-split-dns-claims-re" class="internal xref">New PvD Split DNS Claims Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3.2.1">
                    <p id="section-toc.1-1.13.2.3.2.1.1"><a href="#section-13.3.1" class="auto internal xref">13.3.1</a>.  <a href="#name-guidelines-for-the-designat" class="internal xref">Guidelines for the Designated Experts</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-dns-underscore-name" class="internal xref">DNS Underscore Name</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">To resolve a DNS query, there are three main behaviors that an
      implementation can apply: (1) answer from a local database, (2) query
      the relevant authorities and their parents, or (3) ask a server to query
      those authorities and return the final answer. Implementations that use
      these behaviors are called "authoritative nameservers", "full/recursive
      resolvers", and "forwarders" (or "stub resolvers") respectively. However, an
      implementation can also implement a mixture of these behaviors,
      depending on a local policy, for each query. Such an implementation
      is termed a "hybrid resolver".<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Most DNS resolvers are hybrids of some kind. For example, stub
      resolvers support a local "hosts file" that preempts query
      forwarding, and most DNS forwarders and full resolvers can also serve
      responses from a local zone file. Other standardized hybrid resolution
      behaviors include <span><a href="#RFC8806" class="internal xref">Local Root</a> [<a href="#RFC8806" class="cite xref">RFC8806</a>]</span>, <span><a href="#RFC6762" class="internal xref">mDNS</a> [<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>, and <span><a href="#RFC7686" class="internal xref">NXDOMAIN
      synthesis for .onion</a> [<a href="#RFC7686" class="cite xref">RFC7686</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Networks usually offer clients a DNS resolver using means such as
      (e.g., DHCP OFFER, IPv6 Router Advertisement). Although this resolver is
      formally specified as a recursive resolver (e.g., <span><a href="https://rfc-editor.org/rfc/rfc8106#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC8106" class="cite xref">RFC8106</a>]</span>), some networks provide a hybrid resolver
      instead. If this resolver acts as an authoritative server for some names
      and provides different answers for those domains depending on the source
      of the query, it is described as the network having "split-horizon DNS", because those
      names resolve in this way only from inside the network.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">DNS clients that use pure stub resolution, sending all queries to
      the network-provided resolver, will always receive the split-horizon
      results. Conversely, clients that send all queries to a different
      resolver or implement pure full resolution locally will never receive
      them. Clients that strictly implement either of these resolution behaviors are out of scope for
      this specification. Instead, this specification enables hybrid clients
      to access split-horizon results from a network-provided hybrid resolver,
      while using a different resolution method for some or all other
      names.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">There are several existing mechanisms for a network to provide
      clients with "local domain hints", listing domain names that have
      special treatment in this network (e.g., <span><a href="#RFC6731" class="internal xref">RDNSS Selection</a> [<a href="#RFC6731" class="cite xref">RFC6731</a>]</span>, <span><a href="#RFC5986" class="internal xref">"Access Network Domain Name"</a> [<a href="#RFC5986" class="cite xref">RFC5986</a>]</span>, and "Client FQDN" <span>[<a href="#RFC4702" class="cite xref">RFC4702</a>]</span><span>[<a href="#RFC4704" class="cite xref">RFC4704</a>]</span> in DHCP, "dnsZones" in
      Provisioning Domains <span>[<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>, and <span><a href="#RFC8598" class="internal xref">INTERNAL_DNS_DOMAIN</a> [<a href="#RFC8598" class="cite xref">RFC8598</a>]</span> in IKEv2).
      However, none of the local domain hint mechanisms enables clients to
      determine whether this special treatment is authorized by the domain
      owner. Instead, these specifications require clients to make their own
      determinations about whether to trust and rely on these hints.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This document describes a mechanism between domain names, networks,
      and clients that allows the network to establish its authority over a
      domain to a client (<a href="#establishing" class="auto internal xref">Section 5</a>). Clients can
      use this protocol to confirm that a local domain hint was authorized by
      the domain owner (<a href="#validating" class="auto internal xref">Section 6</a>), which might influence
      its processing of that hint.  This process requires cooperation between
      the local DNS zone and the public zone.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This specification relies on securely identified local DNS servers,
      and checks each local domain hint against a globally valid parent zone.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
      "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
      "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14
      <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span><span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and
      only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document makes use of the terms defined in <span>[<a href="#RFC9499" class="cite xref">RFC9499</a>]</span>, e.g., "Global DNS".  The following additional terms are
      used throughout the document:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Encrypted DNS</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">A DNS protocol that provides an
        encrypted channel between a DNS client and server (e.g., DNS
        over TLS (DoT) <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>, HTTPS (DoH) <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span>, QUIC (DoQ) <span>[<a href="#RFC9250" class="cite xref">RFC9250</a>]</span>).<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Encrypted DNS resolver</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">Refers to a DNS resolver
        that supports any encrypted DNS scheme.<a href="#section-2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Split-Horizon DNS</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">The DNS service provided by a resolver
          that also acts as an authoritative server for some names, providing
          resolution results that are meaningfully different from those in the
          Global DNS. (See "Split DNS" in <span><a href="https://rfc-editor.org/rfc/rfc9499#section-6" class="relref">Section 6</a> of [<a href="#RFC9499" class="cite xref">RFC9499</a>]</span>.)<a href="#section-2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Validated Split-Horizon</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">A split horizon configuration for
          some name is considered "validated" if the client has confirmed that
          a parent of that name has authorized this resolver  to serve its own
          responses for that name. Such authorization generally extends to the
          entire subtree of names below the authorization point.<a href="#section-2-3.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">In this document, the terms 'owner' and 'operator' are used interchangeably
      and refer to the individual or entity responsible for the management and
      maintenance of domains.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3">
      <h2 id="name-scope">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
      </h2>
<p id="section-3-1">The protocol in this document is designed to support the ability of
      a domain owner to create or authorize a split-horizon view of their
      domain. The protocol does not support split-horizon views created by
      any other entity. Thus, DNS filtering is not enabled by this protocol.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The protocol is applicable to any type of network offering
      split-horizon DNS configuration. The endpoint does not need any prior
      configuration to confirm that a local domain hint was indeed authorized
      by the domain.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">All of the special-use domain names registered with IANA <span>[<a href="#RFC6761" class="cite xref">RFC6761</a>]</span>,
      most notably ".home.arpa", "resolver.arpa.", "ipv4only.arpa." and ".local", are never
      unique to a specific DNS server's authority. All special-use domain names are outside the
      scope of this document and MUST NOT be validated using the mechanism described in this document.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4"> Use of this specification is limited to DNS servers that support authenticated encryption and
      split-horizon DNS names that are rooted in the global DNS.<a href="#section-3-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-4-1">This solution seeks to fulfill the following requirements:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">No loss of security: No unauthorized party can impersonate
          a zone unless they could already do so without use of this
          specification.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">Least privilege: Local resolvers do not hold any
          secrets that could weaken the security of the public zone if
          compromised.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">Local zone confidentiality: The specification does not leak
          local network subdomains to anyone outside of the network.<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4">Flexibility: The specification can represent and authorize
          a Split DNS zone structure.<a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.5">DNSSEC Compatibility: The specification supports DNSSEC-based
          <span>[<a href="#RFC9364" class="cite xref">RFC9364</a>]</span> object security for local zone contents.<a href="#section-4-2.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<div id="establishing">
<section id="section-5">
      <h2 id="name-establishing-local-dns-auth">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-establishing-local-dns-auth" class="section-name selfRef">Establishing Local DNS Authority</a>
      </h2>
<p id="section-5-1">A participating network <span class="bcp14">MUST</span> offer one or more
      encrypted resolvers via DHCP and Router Advertisement Options for the
      Discovery of Network-designated Resolvers (DNR) <span>[<a href="#RFC9463" class="cite xref">RFC9463</a>]</span>,
      Discovery of Designated Resolvers (DDR) <span>[<a href="#RFC9462" class="cite xref">RFC9462</a>]</span>, or an
      equivalent mechanism (see <a href="#vpn" class="auto internal xref">Section 10</a>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">To establish local authority, the network MUST convey one or more
      "Authorization Claims" to the client.  An "Authorization Claim" is an
      abstract structure comprising:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">An Authentication Domain Name (ADN) of a local encrypted resolver.<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.2">The DNS name of the authorizing parent zone.<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.3">A set of subdomains of this parent zone that are claimed by
            the named local resolver (potentially including the entire parent
            zone). To claim the entire parent zone, the claimed subdomain
            will be represented as an asterisk symbol "*".<a href="#section-5-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.4">A ZONEMD Hash Algorithm (<span><a href="https://rfc-editor.org/rfc/rfc8976#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8976" class="cite xref">RFC8976</a>]</span>).
           For interoperability purposes implementations MUST support the
           "mandatory to implement" hash algorithms defined in
           <span><a href="https://rfc-editor.org/rfc/rfc8976#section-2.2.3" class="relref">Section 2.2.3</a> of [<a href="#RFC8976" class="cite xref">RFC8976</a>]</span>.<a href="#section-5-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.5">A high-entropy salt, up to 255 octets.<a href="#section-5-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-4">If the local encrypted resolver is identified by name (e.g., DNR), that
      identifying name MUST be the one used in any corresponding Authorization
      Claim.  Otherwise (e.g., DDR using IP addresses), the resolver MUST
      present a validatable certificate containing a subjectAltName that
      matches the Authorization Claim using the validation techniques for
      matching as described in <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span>.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The network then provides each Authorization Claim to the parent zone operator.
      If the contents are approved, the parent zone operator computes a "Verification Token"
      according to the following procedure:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-6">
        <li id="section-5-6.1">Convert all subdomains into canonical form and sort them in canonical
            order (<span><a href="https://rfc-editor.org/rfc/rfc4034#section-6" class="relref">Section 6</a> of [<a href="#RFC4034" class="cite xref">RFC4034</a>]</span>).<a href="#section-5-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.2">Replace the suffix corresponding to the parent zone with a zero
            octet.<a href="#section-5-6.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.3">Let $X be the concatenation of the resulting pseudo-FQDNs.<a href="#section-5-6.3" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.4">Let len($SALT) be the number of octets of salt, as a single octet.<a href="#section-5-6.4" class="pilcrow">¶</a>
</li>
        <li id="section-5-6.5">Let $TOKEN = hash(len($SALT) || $SALT || $X). Where "||" denotes concatenation and hash is the ZONEMD Hash Algorithm.<a href="#section-5-6.5" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-7">The zone operator then publishes a "Verification Record" with the
      following structure, following the best practices outlined in Sections 5.1 and 5.2 of
      <span>[<a href="#I-D.ietf-dnsop-domain-verification-techniques" class="cite xref">I-D.ietf-dnsop-domain-verification-techniques</a>]</span>:<a href="#section-5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-8.1">Type = TXT.<a href="#section-5-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-8.2">Owner Name = Concatenation of the ADN, "_splitdns-challenge", and
            the parent zone name.<a href="#section-5-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-8.3">Contents = "key/value" pairs, e.g., "token=base64url($TOKEN)" (without padding)<a href="#section-5-8.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-9">By publishing this record, the parent zone authorizes the local
      encrypted resolver to serve these subdomains authoritatively.<a href="#section-5-9" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-example">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-example" class="section-name selfRef">Example</a>
        </h3>
<p id="section-5.1-1">Consider the following authorization claim:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">ADN = "resolver17.parent.example"<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">Parent = "parent.example"<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">Subdomains = "payroll.parent.example",
              "secret.project.parent.example"<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">Hash Algorithm = SHA-384 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span><a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.5">Salt = "example salt octets (should be random)"<a href="#section-5.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3">To approve this claim, the zone operator would publish the following record:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">NOTE: '\' line wrapping per <span>[<a href="#RFC8792" class="cite xref">RFC8792</a>]</span><a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-5.1-5">
<pre>
  resolver17.parent.example._splitdns-challenge.parent.example. \
  IN TXT "token=z1qyK7QWwQPkT-ZmVW-tAQbsNyYenTNBPp5ogYB8S1wesVCR\
  -KJDv2eFwfJcWQM"
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
</section>
<section id="section-5.2">
        <h3 id="name-conveying-authorization-cla">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-conveying-authorization-cla" class="section-name selfRef">Conveying Authorization Claims</a>
        </h3>
<p id="section-5.2-1">
          The Authorization Claim is an abstract structure that must be encoded in
          some concrete syntax in order to convey it from the network to the client.
          This section defines some encodings of the Authorization Claims.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<section id="section-5.2.1">
          <h4 id="name-using-dhcp">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-using-dhcp" class="section-name selfRef">Using DHCP</a>
          </h4>
<p id="section-5.2.1-1">
            In DHCP, each Authorization Claim is encoded as a DHCP Authentication
            Option (<span>[<a href="#RFC3118" class="cite xref">RFC3118</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8415#section-21.11" class="relref">Section 21.11</a> of [<a href="#RFC8415" class="cite xref">RFC8415</a>]</span>),
            using the Protocol value $TBD1, "Split DNS Authentication". In DHCPv4 <span>[<a href="#RFC2131" class="cite xref">RFC2131</a>]</span>, the long-options
            mechanism described in <span><a href="https://rfc-editor.org/rfc/rfc3396#section-8" class="relref">Section 8</a> of [<a href="#RFC3396" class="cite xref">RFC3396</a>]</span> MUST be used if the
            authentication option exceeds the maximum DHCPv4 option size of 255 octets. The Algorithm field
            provides the ZONEMD Hash Algorithm, represented by its registered Value.
            The Replay Detection Method value <span class="bcp14">MUST</span> be 0x00. The Authentication Information
            <span class="bcp14">MUST</span> contain the following information, concatenated:<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-2">
            <li id="section-5.2.1-2.1">The ADN in canonical form.<a href="#section-5.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-2.2">The parent name in canonical form.<a href="#section-5.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-2.3">A one-octet "salt length" field.<a href="#section-5.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-2.4">The salt value.<a href="#section-5.2.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-2.5">The $X value defined in <a href="#establishing" class="auto internal xref">Section 5</a>.<a href="#section-5.2.1-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
<div id="splitclaims">
<section id="section-5.2.2">
          <h4 id="name-using-provisioning-domains">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-using-provisioning-domains" class="section-name selfRef">Using Provisioning Domains</a>
          </h4>
<p id="section-5.2.2-1">When using <span><a href="#RFC8801" class="internal xref">Provisioning Domains</a> [<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>, the
          Authorization Claims are represented by the PvD Additional
          Information key "splitDnsClaims", whose value is a
          JSON Array.  Each entry in the array <span class="bcp14">MUST</span> be a JSON object
          with the following structure:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.1">"resolver": The ADN as a dot-separated name.<a href="#section-5.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.2">"parent": The parent zone name as a dot-separated name.<a href="#section-5.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.3">"subdomains": An array containing the claimed subdomains, as
                dot-separated names with the parent suffix already removed, in
                canonical order. To claim the entire parent zone, the claimed subdomain
                will be represented as an asterisk symbol "*".<a href="#section-5.2.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.4">"algorithm": The hash algorithm is represented by its "Mnemonic"
                string from the ZONEMD Hash Algorithms registry (<span>[<a href="#RFC8976" class="cite xref">RFC8976</a>], <a href="https://rfc-editor.org/rfc/rfc8976#section-5.2" class="relref">Section 5.2</a></span>).<a href="#section-5.2.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.5">"salt": The salt, encoded in base64url <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>.<a href="#section-5.2.2-2.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-3">Future specifications aiming to define new keys will need to add them to the
        IANA registry defined in <a href="#IANA" class="auto internal xref">Section 13</a>. DNS client implementations
        will ignore any keys they don't recognize but may also report about
        unknown keys.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</section>
</div>
<div id="validating">
<section id="section-6">
      <h2 id="name-validating-authority-over-l">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-validating-authority-over-l" class="section-name selfRef">Validating Authority over Local Domain Hints</a>
      </h2>
<p id="section-6-1">To validate an Authorization Claim provided by the network, DNS clients
      <span class="bcp14">MUST</span> resolve the Verification Record for that name.
      If the resolution produces an RRSet containing the expected token for this
      Claim, the client <span class="bcp14">SHALL</span> regard the named resolver as
      authoritative for the claimed subdomains. Clients <span class="bcp14">MUST</span> ignore
      any unrecognized keys in the Verification Record.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Each validation of authority applies only to a specific ADN.
      If a network offers multiple encrypted resolvers, each claimed
      subdomain may be authorized for a distinct subset of the network-provided
      resolvers.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A zone is termed a "Validated Split-Horizon zone" after successful
      validation using a "tamperproof" DNS resolution method, i.e., a method
      that is not subject to interference by the local network operator. Two
      possible tamperproof resolution methods are presented below.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="validating-external">
<section id="section-6.1">
        <h3 id="name-using-a-pre-configured-exte">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-using-a-pre-configured-exte" class="section-name selfRef">Using a Pre-configured External Resolver</a>
        </h3>
<p id="section-6.1-1">This method applies only if the client is already configured with
        a default resolution strategy that sends queries to a resolver outside
        of the network over a encrypted transport.  That resolution strategy is
        considered "tamperproof" because any actor who could modify the
        response could already modify all of the user's other DNS responses.
        If the client cannot obtain a response from the external resolver within a
        reasonable timeout period, it MUST consider the verification process
        to have failed.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">To ensure that this assumption holds, clients <span class="bcp14">MUST NOT</span>
        relax the acceptance rules they would otherwise apply when using this
        resolver. For example, if the client would check the Authenticated Data (AD)
        bit or validate RRSIGs locally when using this resolver, it must also do so
        when resolving TXT records for this purpose. Alternatively, a client might
        perform DNSSEC validation for the verification query
        even if it has disabled DNSSEC validation for other DNS queries.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validating-dnssec">
<section id="section-6.2">
        <h3 id="name-using-dnssec">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-using-dnssec" class="section-name selfRef">Using DNSSEC</a>
        </h3>
<p id="section-6.2-1">The client resolves the Verification Record using any resolution method of
        its choice (e.g., querying one of the network-provided resolvers,
        performing iterative resolution locally), and performs full DNSSEC
        validation locally <span>[<a href="#RFC6698" class="cite xref">RFC6698</a>]</span>. The result is
        processed based on its DNSSEC validation state (<span>[<a href="#RFC4035" class="cite xref">RFC4035</a>], <a href="https://rfc-editor.org/rfc/rfc4035#section-4.3" class="relref">Section 4.3</a></span>):<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2-2.1">
            <strong>Secure</strong>: The response is used for validation.<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-6.2-2.2">
            <strong>Bogus</strong> or <strong>Indeterminate</strong>: The response is rejected and
            validation is considered to have failed.<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-6.2-2.3">
            <strong>Insecure</strong>: The client <span class="bcp14">SHOULD</span> retry the validation
            process using a different method, such as the one in <a href="#validating-external" class="auto internal xref">Section 6.1</a>, to ensure compatibility with
            unsigned names. If the client chooses not to retry (e.g., no configured policy to validate
            the authorization claim using an external resolver), it MUST consider
            validation to have failed.<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-delegating-dnssec-across-sp">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-delegating-dnssec-across-sp" class="section-name selfRef">Delegating DNSSEC across Split DNS Boundaries</a>
      </h2>
<p id="section-7-1">When the local zone can be signed with globally trusted keys for the parent
      zone, support for DNSSEC can be accomplished simply by placing a zone cut at
      the parent zone and including a suitable DS record for the local resolver's
      DNSKEY.  Zones in this configuration appear the same to validating stubs whether
      or not they implement this specification.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">To enable DNSSEC validation of local DNS names without requiring
      the local resolver to hold DNSSEC private keys that are valid for the parent
      zone, parent zones <span class="bcp14">MAY</span> add a "ds=..." key to the Verification
      Record whose value is the RDATA of a single DS record, base64url-encoded. This
      DS record authorizes a DNSKEY whose Owner Name is "resolver.arpa."<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">To validate DNSSEC, the client first fetches and validates the Verification
      Record.  If it is valid and contains a "ds" key, the client <span class="bcp14">MAY</span>
      send a DNSKEY query for "resolver.arpa." to the local encrypted resolver.
      At least one resulting DNSKEY RR <span class="bcp14">MUST</span> match the DS RDATA from
      the "ds" key in the Verification Record. All local resolution results for
      subdomains in this claim <span class="bcp14">MUST</span> offer RRSIGs that chain to a
      DNSKEY whose RDATA is identical to one of these approved DNSKEYs.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The "ds" key <span class="bcp14">MAY</span> appear multiple
      times in a single Verification Record, in order to authorize multiple DNSKEYs
      for this local encrypted resolver.  If the "ds" key is not present in a valid
      Verification Record, the client <span class="bcp14">MUST</span> disable DNSSEC validation
      when resolving the claimed subdomains via this local encrypted resolver.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">Note that in this configuration, any claimed subdomains MUST be marked as
      unsigned in the public DNS.  Otherwise, resolution results would be rejected
      by validating stubs that do not implement this specification.<a href="#section-7-5" class="pilcrow">¶</a></p>
<span id="name-example-use-of-ds"></span><figure id="figure-1">
        <div class="sourcecode" id="section-7-6.1">
<pre>
;; Parent zone.
$ORIGIN parent.example.

; Parent zone's public KSK and ZSK
@ IN DNSKEY 257 3 5 ABCD...=
@ IN DNSKEY 256 3 5 DCBA...=

; Verification Record containing DS RDATA for the local
; resolver's KSK.  This is an ordinary public TXT record,
; secured by RRSIGs from the public ZSK.
resolver.example._splitdns-challenge IN TXT "token=abc...,ds=QWE..."

; NSEC record indicating that unsigned delegations are permitted at
; this subdomain.  This is required for compatibility with non-split-aware
; validating stub resolvers.  If the claimed label is confidential, the
; parent zone can conceal it using NSEC3 (with or without "opt-out").
@ IN NSEC subdomain.parent.example. NS

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; Local zone, claiming "subdomain.parent.example".

; The local resolver's KSK, validated by the Verification Record.
; It may not have a corresponding RRSIG.
resolver.arpa. IN DNSKEY 257 3 5 ASDF...=

; Each claimed subdomain duplicates the local resolver's KSK at its
; zone apex and uses it to sign the ZSK.
subdomain.parent.example.        IN DNSKEY 257 3 5 ASDF...=
subdomain.parent.example.        IN DNSKEY 256 3 5 FDSA...=
subdomain.parent.example         IN RRSIG DNSKEY 5 3 ...  \
        (KSK key tag) subdomain.parent.example. ...
subdomain.parent.example.        IN AAAA 2001:db8::17
subdomain.parent.example         IN RRSIG AAAA 5 3 ...    \
        (ZSK key tag) subdomain.parent.example. ...
deeper.subdomain.parent.example. IN AAAA 2001:db8::18
deeper.subdomain.parent.example  IN RRSIG AAAA 5 3 ...    \
        (ZSK key tag) subdomain.parent.example. ...
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-use-of-ds" class="selfRef">Example use of "ds=..."</a>
        </figcaption></figure>
</section>
<section id="section-8">
      <h2 id="name-examples-of-split-horizon-d">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-examples-of-split-horizon-d" class="section-name selfRef">Examples of Split-Horizon DNS Configuration</a>
      </h2>
<p id="section-8-1">Two examples are shown below. The first example shows a company
      with an internal-only DNS server that claims the entire zone for that
      company (e.g., <code>*.example.com</code>). In the second example, the
      internal servers resolves only a
      subdomain of the company's zone (e.g., <code>*.internal.example.com</code>).<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="internal-only">
<section id="section-8.1">
        <h3 id="name-split-horizon-entire-zone">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-split-horizon-entire-zone" class="section-name selfRef">Split-Horizon Entire Zone</a>
        </h3>
<p id="section-8.1-1">Consider an organization that operates "example.com", and runs a
        different version of its global domain on its internal network.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">First, the host and network both need to support one of the discovery
        mechanisms described in <a href="#establishing" class="auto internal xref">Section 5</a>. <a href="#fig-learn" class="auto internal xref">Figure 2</a>
        shows discovery using DNR and PvD.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Validation is then perfomed using either <span><a href="#example-verify-external" class="internal xref">an external resolver</a> (<a href="#example-verify-external" class="auto internal xref">Section 8.1.1</a>)</span> or <span><a href="#example-verify-dnssec" class="internal xref">DNSSEC</a> (<a href="#example-verify-dnssec" class="auto internal xref">Section 8.1.2</a>)</span>.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-4.1">
            <strong>Steps 1-2</strong>: The client determines the network's DNS
            server (dns.example.net) and Provisioning Domain (pvd.example.com)
            using <span><a href="#RFC9463" class="internal xref">DNR</a> [<a href="#RFC9463" class="cite xref">RFC9463</a>]</span> and <span><a href="#RFC8801" class="internal xref">PvD</a> [<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>, using one of DNR Router Solicitation,
            DHCPv4, or DHCPv6.<a href="#section-8.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-8.1-4.2">
            <strong>Step 3-5</strong>: The client connects to dns.example.net
            using an encrypted transport as indicated in <span><a href="#RFC9463" class="internal xref">DNR</a> [<a href="#RFC9463" class="cite xref">RFC9463</a>]</span>, authenticating the server to
            its name using TLS (<span>[<a href="#RFC8310" class="cite xref">RFC8310</a>], <a href="https://rfc-editor.org/rfc/rfc8310#section-8" class="relref">Section 8</a></span>), and
            sends it a query for the address of <code>pvd.example.com</code>.<a href="#section-8.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-8.1-4.3">
            <p id="section-8.1-4.3.1"><strong>Steps 6-7</strong>: The client connects to the PvD server,
            validates its certificate, and retrieves the provisioning domain
            JSON information indicated by the associated PvD. The PvD
            contains:<a href="#section-8.1-4.3.1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-8.1-4.3.2">
<pre>{
  "identifier": "pvd.example.com",
  "expires": "2025-05-23T06:00:00Z",
  "prefixes": ["2001:db8:1::/48", "2001:db8:4::/48"],
  "splitDnsClaims": [{
    "resolver": "dns.example.net",
    "parent": "example.com",
    "subdomains": ["*"],
    "algorithm": "SHA384",
    "salt": "abc...123"
  }]
}</pre><a href="#section-8.1-4.3.2" class="pilcrow">¶</a>
</div>
<p id="section-8.1-4.3.3">The JSON keys "identifier", "expires", and "prefixes"
            are defined in <span>[<a href="#RFC8801" class="cite xref">RFC8801</a>]</span>.<a href="#section-8.1-4.3.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-an-example-of-learning-loca"></span><div id="fig-learn">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-8.1-5.1">
<pre>
+---------+         +--------------------+  +------------+ +--------+
| Client  |         | Network's          |  | Network    | | Router |
|         |         | Encrypted Resolver |  | PvD Server | |        |
+---------+         +--------------------+  +------------+ +--------+
   |                                     |         |            |
   | Router Solicitation or              |         |            |
   | DHCPv4/DHCPv6 (1)                   |         |            |
   |-----------------------------------------------------------&gt;|
   |                                     |         |            |
   |  Response with DNR ADN &amp;            |         |            |
   |  PvD FQDN (2)                       |         |            |
   |&lt;-----------------------------------------------------------|
   | ----------------------------\       |         |            |
   |-| now knows DNR ADN &amp;       |       |         |            |
   | | PvD FQDN                  |       |         |            |
   | |---------------------------/       |         |            |
   |                                     |         |            |
   | TLS connection to dns.example.net (3)         |            |
   |------------------------------------&gt;|         |            |
   | ---------------------------\        |         |            |
   |-| validate TLS certificate |        |         |            |
   | |--------------------------/        |         |            |
   |                                     |         |            |
   | resolve pvd.example.com  (4)        |         |            |
   |------------------------------------&gt;|         |            |
   |                                     |         |            |
   |            A or AAAA records (5)    |         |            |
   |&lt;------------------------------------|         |            |
   |                                     |         |            |
   | https://pvd.example.com/.well-known/pvd (6)   |            |
   |----------------------------------------------&gt;|            |
   |                                     |         |            |
   |  200 OK (JSON Additional Information) (7)     |            |
   |&lt;----------------------------------------------|            |
   | ----------------------------------\ |         |            |
   |-| {..., "splitDnsClaims": [...] } | |         |            |
   | |---------------------------------/ |         |            |
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-an-example-of-learning-loca" class="selfRef">An Example of Learning Local Claims of DNS Authority</a>
          </figcaption></figure>
</div>
<div id="example-verify-external">
<section id="section-8.1.1">
          <h4 id="name-verification-using-an-exter">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-verification-using-an-exter" class="section-name selfRef">Verification Using an External Resolver</a>
          </h4>
<p id="section-8.1.1-1"><a href="#fig-learn2" class="auto internal xref">Figure 3</a> shows the steps performed to verify the local
          claims of DNS authority using an external resolver.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1.1-2.1">
              <strong>Steps 1-2</strong>: The client uses an encrypted DNS
              connection to an external resolver to issue TXT
              queries for the Verification Records. The TXT lookup returns
              a token that matches the claim.<a href="#section-8.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-8.1.1-2.2">
              <strong>Step 3</strong>: The client has validated that
              <code>example.com</code> has authorized <code>dns.example.net</code>
              to serve <code>example.com</code>. When the client connects using an
              encrypted transport as indicated in <span><a href="#RFC9463" class="internal xref">DNR</a> [<a href="#RFC9463" class="cite xref">RFC9463</a>]</span>, it will authenticate
              the server to its name using TLS (<span>[<a href="#RFC8310" class="cite xref">RFC8310</a>], <a href="https://rfc-editor.org/rfc/rfc8310#section-8" class="relref">Section 8</a></span>), and send queries to resolve
              any names that fall within the claimed zones.<a href="#section-8.1.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-verifying-claims-using-an-e"></span><div id="fig-learn2">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-8.1.1-3.1">
<pre>
+---------+                  +--------------------+  +----------+
| Client  |                  | Network's          |  | External |
|         |                  | Encrypted Resolver |  | Resolver |
+---------+                  +--------------------+  +----------+
     |                                          |         |
     | TLS connection                           |         |
     |---------------------------------------------------&gt;|
     | ---------------------------\             |         |
     |-| validate TLS certificate |             |         |
     | |--------------------------|             |         |
     |                                          |         |
     | TXT? dns.example.net.\                   |         |
     |   _splitdns-challenge.example.com  (1)   |         |
     |---------------------------------------------------&gt;|
     |                                          |         |
     |  TXT "token=ABC..."                  (2) |         |
     |&lt;---------------------------------------------------|
     | --------------------------------\        |         |
     |-| dns.example.net is authorized |        |         |
     | ----------------------\---------|        |         |
     |-| finished validation |                  |         |
     | |---------------------|                  |         |
     |                                          |         |
     |  use dns.example.net when                |         |
     |  resolving example.com (3)               |         |
     |-----------------------------------------&gt;|         |
     |                                          |         |
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-verifying-claims-using-an-e" class="selfRef">Verifying claims using an external resolver</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="example-verify-dnssec">
<section id="section-8.1.2">
          <h4 id="name-verification-using-dnssec">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-verification-using-dnssec" class="section-name selfRef">Verification using DNSSEC</a>
          </h4>
<p id="section-8.1.2-1"><a href="#fig-learn3" class="auto internal xref">Figure 4</a> shows the steps performed to verify the local
          claims of DNS authority using DNSSEC.<a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1.2-2.1">
              <strong>Steps 1-2</strong>: The DNSSEC-validating client queries
              the network encrypted resolver to issue TXT queries for the
              Verification Records. The TXT lookup will return
              a signed response containing the expected token. The client then
              performs full DNSSEC validation locally.<a href="#section-8.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-8.1.2-2.2">
              <strong>Step 3</strong>: If the DNSSEC validation is successful and
              the token matches, then this Authorization Claim is validated.
              Once the client connects using an encrypted transport as indicated
              in <span><a href="#RFC9463" class="internal xref">DNR</a> [<a href="#RFC9463" class="cite xref">RFC9463</a>]</span>, it will authenticate
              the server to its name using TLS (<span>[<a href="#RFC8310" class="cite xref">RFC8310</a>], <a href="https://rfc-editor.org/rfc/rfc8310#section-8" class="relref">Section 8</a></span>), and send queries to resolve
              any names that fall within the claimed zones.<a href="#section-8.1.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-an-example-of-verifying-cla"></span><div id="fig-learn3">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-8.1.2-3.1">
<pre>
+---------+                                    +--------------------+
| Client  |                                    | Network's          |
|         |                                    | Encrypted Resolver |
+---------+                                    +--------------------+
  |                                                               |
  | DNSSEC OK (DO), TXT? dns.example.net.\                        |
  |   _splitdns-challenge.example.com  (1)                        |
  |--------------------------------------------------------------&gt;|
  |                                                               |
  | TXT token=DEF..., Signed Answer (RRSIG) (2)                   |
  |&lt;--------------------------------------------------------------|
  | -------------------------------------\                        |
  |-| DNSKEY+TXT matches RRSIG, use TXT  |                        |
  | |------------------------------------|                        |
  | --------------------------------\                             |
  |-| dns.example.net is authorized |                             |
  | |-------------------------------|                             |
  | ----------------------\                                       |
  |-| finished validation |                                       |
  | |---------------------|                                       |
  |                                                               |
  | use encrypted network-designated resolver for example.com (3) |
  |--------------------------------------------------------------&gt;|
  |                                                               |
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-an-example-of-verifying-cla" class="selfRef">An Example of Verifying Claims using DNSSEC</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
<div id="operatonal">
<section id="section-9">
      <h2 id="name-operational-efficiency-in-s">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-operational-efficiency-in-s" class="section-name selfRef">Operational Efficiency in Split-Horizon Deployments</a>
      </h2>
<p id="section-9-1">In many split-horizon deployments, all non-public domain names are
        placed in a separate child zone (e.g., <code>internal.example.com</code>).
        In this configuration, the message flow is similar to <a href="#internal-only" class="auto internal xref">Section 8.1</a>, except that queries for hosts not within the
        subdomain (e.g., <code>www.example.com</code>) are sent to the
        external resolver rather than the resolver for internal.example.com.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">As in <a href="#internal-only" class="auto internal xref">Section 8.1</a>, the internal DNS
        server will need a certificate signed by a Certification Authority (CA) trusted by the
        client.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Although placing internal domains inside a child domain is unnecessary to prevent leakage,
        such placement reduces the frequency of changes to the Verification Record, this document
        recommends the internal domains be kept in a child zone of the local domain hints
        advertised by the network. For example, if the PvD "dnsZones" entry is
        "internal.example.com" and the network-provided DNS resolver is "ns1.internal.example.com",
        the network operator can structure the internal domain names as
        "private1.internal.example.com", "private2.internal.example.com",
        etc. The network-designated resolver will be used to resolve the subdomains of
        the local domain hint "*.internal.example.com".<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vpn">
<section id="section-10">
      <h2 id="name-validation-with-ikev2">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-validation-with-ikev2" class="section-name selfRef">Validation with IKEv2</a>
      </h2>
<p id="section-10-1">When the endpoint is using a VPN tunnel and the tunnel is IPsec, the encrypted DNS resolver hosted by
      the VPN service provider can be securely discovered by the endpoint
      using the ENCDNS_IP*_* IKEv2 Configuration Payload Attribute Types
      defined in <span>[<a href="#RFC9464" class="cite xref">RFC9464</a>]</span>. The VPN client
      can use the mechanism defined in Section 6 to validate that the discovered
      encrypted DNS resolver is authorized to answer for the claimed subdomains.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Other VPN tunnel types have similar configuration capabilities, not
      detailed here.<a href="#section-10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aclaim">
<section id="section-11">
      <h2 id="name-authorization-claim-update">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-authorization-claim-update" class="section-name selfRef">Authorization Claim Update</a>
      </h2>
<p id="section-11-1">A verification record is only valid until it expires. Expiry occurs when the Time To Live (TTL)
      or DNSSEC signature validity period ends. Shortly before verification record expiry, clients MUST
      fetch the verification records again and repeat the verification procedure. This ensures the
      availability of updated and valid verification records.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">A new verification record must be added to the RRset before the corresponding Authorization
      Claim is updated.  After the claim is updated, the following procedures can be used:<a href="#section-11-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11-3">
        <li id="section-11-3.1">DHCP reconfiguration can be initiated by a DHCP server that has previously communicated with a DHCP client and
   negotiated for the DHCP client to listen for Reconfigure messages, to prompt the DHCP clients for
        dynamically requesting the updated Authorization Claim. This process avoids the need for
        the client to wait for its current lease to complete and request a new one, enabling the lease
        renewal to be driven by the DHCP server.<a href="#section-11-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-11-3.2">The sequence number in the RA PvD option
        will be incremented, requiring clients to fetch PvD additional information from the HTTPS
        server due to the updated sequence number in the new RA (<span>[<a href="#RFC8801" class="cite xref">RFC8801</a>], <a href="https://rfc-editor.org/rfc/rfc8801#section-4.1" class="relref">Section 4.1</a></span>).<a href="#section-11-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-11-3.3">The old verification record needs to be maintained until the DHCP lease time or PvD
        Additional Information expiry.<a href="#section-11-3.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="Security">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">The Authentication Domain Names of authorized local encrypted resolvers are
      revealed in the Owner Names of Verification Records.  This makes it easier for
      domain owners to understand which resolvers they are currently authorizing to
      implement Split DNS. However, this could create a confidentiality issue if the
      local encrypted resolver's name contains sensitive information or is part of a
      secret subdomain. To mitigate the impact of such leakage, local resolvers should
      be given names that do not reveal any sensitive information.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2"> The security properties of hashing algorithms are not fixed. Algorithm Agility
      (see <span>[<a href="#RFC7696" class="cite xref">RFC7696</a>]</span>) is achieved by providing implementations with
      flexibility to choose hashing algorithms from the ZONEMD Schemes registry
      (<span>[<a href="#RFC8976" class="cite xref">RFC8976</a>], <a href="https://rfc-editor.org/rfc/rfc8976#section-5.2" class="relref">Section 5.2</a></span>).<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">The entropy of salt depends on a high-quality pseudo-random number generator.
      For further discussion on random number generation, see <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span>.
      The salt MUST be regenerated whenever the authorization claim is updated.<a href="#section-12-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-dhcp-split-dns-authenticati">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-dhcp-split-dns-authenticati" class="section-name selfRef">DHCP Split DNS Authentication Algorithm</a>
        </h3>
<p id="section-13.1-1">IANA is requested to add the following entry to the "Protocol Name Space
        Values" registry on the "Dynamic Host Configuration Protocol (DHCP)
        Authentication Option Name Spaces" page:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-2.1">Value: $TBD1<a href="#section-13.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.1-2.2">Description: Split-horizon DNS<a href="#section-13.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.1-2.3">Reference: (This Document)<a href="#section-13.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-13.2">
        <h3 id="name-provisioning-domains-split-">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-provisioning-domains-split-" class="section-name selfRef">Provisioning Domains Split DNS Additional Information</a>
        </h3>
<p id="section-13.2-1">IANA is requested to add the following entry to the "Additional
        Information PvD Keys" registry under the "Provisioning Domains (PvDs)" registry group:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.1">JSON key: "splitDnsClaims"<a href="#section-13.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.2-2.2">Description: "Verifiable locally served domains"<a href="#section-13.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.2-2.3">Type: Array of Objects<a href="#section-13.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.2-2.4">
            <p id="section-13.2-2.4.1">Example:<a href="#section-13.2-2.4.1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-13.2-2.4.2">
<pre>[{
  "resolver": "dns.example.net",
  "parent": "example.com",
  "subdomains": ["sub"],
  "algorithm": "SHA384",
  "salt": "abc...123"
}]</pre><a href="#section-13.2-2.4.2" class="pilcrow">¶</a>
</div>
</li>
          <li class="normal" id="section-13.2-2.5">Reference: (This document)<a href="#section-13.2-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-13.3">
        <h3 id="name-new-pvd-split-dns-claims-re">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-new-pvd-split-dns-claims-re" class="section-name selfRef">New PvD Split DNS Claims Registry</a>
        </h3>
<p id="section-13.3-1">IANA is requested to create a new registry "PvD Split DNS Claims" Registry,
        within the "Provisioning Domains (PvDs)" registry page.  This new registry
        reserves JSON keys for use in sub-dictionaries under the splitDnsClaims JSON key.
        The initial contents of this registry, as discussed in <a href="#splitclaims" class="auto internal xref">Section 5.2.2</a>,
        are listed below and will be added to the IANA registry:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<span id="name-split-dns-claims"></span><div id="fig-split-claims">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-13.3-2.1">
<pre>
+------------+-----------------------+---------+-----------------+-----------+
| JSON key   | Description           | Type    | Example         | Reference |
+------------+-----------------------+---------+-----------------+-----------+
| resolver   | The Authentication    | String  |"dns.example.net"| [RFCXXXX] |
|            | Domain Name           |         |                 |           |
|            |                       |         |                 |           |
| parent     | The parent zone name  | String  | "example.com"   | [RFCXXXX] |
|            |                       |         |                 |           |
| subdomains | An array containing   | Array of| ["sub"]         |           |
|            | the claimed subdomains| Strings |                 | [RFCXXXX] |
|            |                       |         |                 |           |
| algorithm  | The hash algorithm    | String  | "SHA384"        | [RFCXXXX] |
|            |                       |         |                 |           |
| salt       | The salt (base64url)  | String  | "abc...123"     | [RFCXXXX] |
|            |                       |         |                 |           |
+------------+-----------------------+---------+-----------------+-----------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-split-dns-claims" class="selfRef">Split DNS Claims</a>
          </figcaption></figure>
</div>
<p id="section-13.3-3">The keys defined in this document are mandatory. Any new assignments of keys will be considered
        as optional for the purpose of the mechanism described in this document.<a href="#section-13.3-3" class="pilcrow">¶</a></p>
<p id="section-13.3-4">New assignments in the "PvD Split DNS Claims Registry" registry will be
        administered by IANA through Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Experts are
        requested to ensure that defined keys do not overlap in names or semantics.<a href="#section-13.3-4" class="pilcrow">¶</a></p>
<section id="section-13.3.1">
          <h4 id="name-guidelines-for-the-designat">
<a href="#section-13.3.1" class="section-number selfRef">13.3.1. </a><a href="#name-guidelines-for-the-designat" class="section-name selfRef">Guidelines for the Designated Experts</a>
          </h4>
<p id="section-13.3.1-1">It is suggested that multiple designated experts be appointed for
          registry change requests.<a href="#section-13.3.1-1" class="pilcrow">¶</a></p>
<p id="section-13.3.1-2">Criteria that should be applied by the designated experts include
          determining whether the proposed registration duplicates existing
          entries and whether the registration description is clear and fits
          the purpose of this registry.<a href="#section-13.3.1-2" class="pilcrow">¶</a></p>
<p id="section-13.3.1-3">Registration requests are evaluated within a three-week review period
          on the advice of one or more designated experts. Within the review
          period, the designated experts will either approve or deny the
          registration request, communicating this decision to IANA. Denials
          should include an explanation and, if applicable, suggestions as to
          how to make the request successful.<a href="#section-13.3.1-3" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-13.4">
        <h3 id="name-dns-underscore-name">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-dns-underscore-name" class="section-name selfRef">DNS Underscore Name</a>
        </h3>
<p id="section-13.4-1">IANA is requested to add the following entry to the "Underscored and
        Globally Scoped DNS Node Names" registry under the "Domain Name System (DNS)
        Parameters" registry group:<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.4-2.1">RR Type: TXT<a href="#section-13.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.4-2.2">_NODE NAME: _splitdns-challenge<a href="#section-13.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.4-2.3">Reference: (This document)<a href="#section-13.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
</div>
<section id="section-14">
      <h2 id="name-acknowledgements">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-14-1">Thanks to Mohamed Boucadair, Jim Reid, Tommy Pauly, Paul Vixie, Michael Richardson,
      Bernie Volz, Éric Vyncke and Vinny Parla for the discussion and comments.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">Thanks to Tianran Zhou for the opsdir review, Anthony Somerset for the dnsdir review,
      Watson Ladd for the secdir review, Bob Halley for the intdir review and Mallory Knodel
      for the genart review.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">Thanks to Mohamed Boucadair for the Shepherd review.<a href="#section-14-3" class="pilcrow">¶</a></p>
</section>
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2131">[RFC2131]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"Dynamic Host Configuration Protocol"</span>, <span class="seriesInfo">RFC 2131</span>, <span class="seriesInfo">DOI 10.17487/RFC2131</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2131">https://www.rfc-editor.org/info/rfc2131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3118">[RFC3118]</dt>
        <dd>
<span class="refAuthor">Droms, R., Ed.</span> and <span class="refAuthor">W. Arbaugh, Ed.</span>, <span class="refTitle">"Authentication for DHCP Messages"</span>, <span class="seriesInfo">RFC 3118</span>, <span class="seriesInfo">DOI 10.17487/RFC3118</span>, <time datetime="2001-06" class="refDate">June 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3118">https://www.rfc-editor.org/info/rfc3118</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3396">[RFC3396]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span> and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4)"</span>, <span class="seriesInfo">RFC 3396</span>, <span class="seriesInfo">DOI 10.17487/RFC3396</span>, <time datetime="2002-11" class="refDate">November 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3396">https://www.rfc-editor.org/info/rfc3396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6698">[RFC6698]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schlyter</span>, <span class="refTitle">"The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA"</span>, <span class="seriesInfo">RFC 6698</span>, <span class="seriesInfo">DOI 10.17487/RFC6698</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6698">https://www.rfc-editor.org/info/rfc6698</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6761">[RFC6761]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Special-Use Domain Names"</span>, <span class="seriesInfo">RFC 6761</span>, <span class="seriesInfo">DOI 10.17487/RFC6761</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6761">https://www.rfc-editor.org/info/rfc6761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
        <dd>
<span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Volz, B.</span>, <span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8801">[RFC8801]</dt>
        <dd>
<span class="refAuthor">Pfister, P.</span>, <span class="refAuthor">Vyncke, É.</span>, <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Schinazi, D.</span>, and <span class="refAuthor">W. Shao</span>, <span class="refTitle">"Discovering Provisioning Domain Names and Data"</span>, <span class="seriesInfo">RFC 8801</span>, <span class="seriesInfo">DOI 10.17487/RFC8801</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8801">https://www.rfc-editor.org/info/rfc8801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8976">[RFC8976]</dt>
        <dd>
<span class="refAuthor">Wessels, D.</span>, <span class="refAuthor">Barber, P.</span>, <span class="refAuthor">Weinberg, M.</span>, <span class="refAuthor">Kumari, W.</span>, and <span class="refAuthor">W. Hardaker</span>, <span class="refTitle">"Message Digest for DNS Zones"</span>, <span class="seriesInfo">RFC 8976</span>, <span class="seriesInfo">DOI 10.17487/RFC8976</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8976">https://www.rfc-editor.org/info/rfc8976</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9525">[RFC9525]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="seriesInfo">RFC 9525</span>, <span class="seriesInfo">DOI 10.17487/RFC9525</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9525">https://www.rfc-editor.org/info/rfc9525</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-dnsop-domain-verification-techniques">[I-D.ietf-dnsop-domain-verification-techniques]</dt>
        <dd>
<span class="refAuthor">Sahib, S. K.</span>, <span class="refAuthor">Huque, S.</span>, <span class="refAuthor">Wouters, P.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Domain Control Validation using DNS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-domain-verification-techniques-04</span>, <time datetime="2024-03-03" class="refDate">3 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-domain-verification-techniques-04">https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-domain-verification-techniques-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4702">[RFC4702]</dt>
        <dd>
<span class="refAuthor">Stapp, M.</span>, <span class="refAuthor">Volz, B.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"The Dynamic Host Configuration Protocol (DHCP) Client Fully Qualified Domain Name (FQDN) Option"</span>, <span class="seriesInfo">RFC 4702</span>, <span class="seriesInfo">DOI 10.17487/RFC4702</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4702">https://www.rfc-editor.org/info/rfc4702</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4704">[RFC4704]</dt>
        <dd>
<span class="refAuthor">Volz, B.</span>, <span class="refTitle">"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"</span>, <span class="seriesInfo">RFC 4704</span>, <span class="seriesInfo">DOI 10.17487/RFC4704</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4704">https://www.rfc-editor.org/info/rfc4704</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5986">[RFC5986]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span> and <span class="refAuthor">J. Winterbottom</span>, <span class="refTitle">"Discovering the Local Location Information Server (LIS)"</span>, <span class="seriesInfo">RFC 5986</span>, <span class="seriesInfo">DOI 10.17487/RFC5986</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5986">https://www.rfc-editor.org/info/rfc5986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6731">[RFC6731]</dt>
        <dd>
<span class="refAuthor">Savolainen, T.</span>, <span class="refAuthor">Kato, J.</span>, and <span class="refAuthor">T. Lemon</span>, <span class="refTitle">"Improved Recursive DNS Server Selection for Multi-Interfaced Nodes"</span>, <span class="seriesInfo">RFC 6731</span>, <span class="seriesInfo">DOI 10.17487/RFC6731</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6731">https://www.rfc-editor.org/info/rfc6731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7686">[RFC7686]</dt>
        <dd>
<span class="refAuthor">Appelbaum, J.</span> and <span class="refAuthor">A. Muffett</span>, <span class="refTitle">"The ".onion" Special-Use Domain Name"</span>, <span class="seriesInfo">RFC 7686</span>, <span class="seriesInfo">DOI 10.17487/RFC7686</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7686">https://www.rfc-editor.org/info/rfc7686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7696">[RFC7696]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <span class="seriesInfo">DOI 10.17487/RFC7696</span>, <time datetime="2015-11" class="refDate">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7696">https://www.rfc-editor.org/info/rfc7696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8106">[RFC8106]</dt>
        <dd>
<span class="refAuthor">Jeong, J.</span>, <span class="refAuthor">Park, S.</span>, <span class="refAuthor">Beloeil, L.</span>, and <span class="refAuthor">S. Madanapalli</span>, <span class="refTitle">"IPv6 Router Advertisement Options for DNS Configuration"</span>, <span class="seriesInfo">RFC 8106</span>, <span class="seriesInfo">DOI 10.17487/RFC8106</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8106">https://www.rfc-editor.org/info/rfc8106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Gillmor, D.</span>, and <span class="refAuthor">T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8598">[RFC8598]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span> and <span class="refAuthor">P. Wouters</span>, <span class="refTitle">"Split DNS Configuration for the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 8598</span>, <span class="seriesInfo">DOI 10.17487/RFC8598</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8598">https://www.rfc-editor.org/info/rfc8598</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8806">[RFC8806]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Running a Root Server Local to a Resolver"</span>, <span class="seriesInfo">RFC 8806</span>, <span class="seriesInfo">DOI 10.17487/RFC8806</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8806">https://www.rfc-editor.org/info/rfc8806</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9250">[RFC9250]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS over Dedicated QUIC Connections"</span>, <span class="seriesInfo">RFC 9250</span>, <span class="seriesInfo">DOI 10.17487/RFC9250</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9250">https://www.rfc-editor.org/info/rfc9250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9364">[RFC9364]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9364">https://www.rfc-editor.org/info/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9462">[RFC9462]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"Discovery of Designated Resolvers"</span>, <span class="seriesInfo">RFC 9462</span>, <span class="seriesInfo">DOI 10.17487/RFC9462</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9462">https://www.rfc-editor.org/info/rfc9462</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9463">[RFC9463]</dt>
        <dd>
<span class="refAuthor">Boucadair, M., Ed.</span>, <span class="refAuthor">Reddy.K, T., Ed.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Cook, N.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"DHCP and Router Advertisement Options for the Discovery of Network-designated Resolvers (DNR)"</span>, <span class="seriesInfo">RFC 9463</span>, <span class="seriesInfo">DOI 10.17487/RFC9463</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9463">https://www.rfc-editor.org/info/rfc9463</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9464">[RFC9464]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Reddy.K, T.</span>, <span class="refAuthor">Wing, D.</span>, and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2) Configuration for Encrypted DNS"</span>, <span class="seriesInfo">RFC 9464</span>, <span class="seriesInfo">DOI 10.17487/RFC9464</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9464">https://www.rfc-editor.org/info/rfc9464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9499">[RFC9499]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 9499</span>, <span class="seriesInfo">DOI 10.17487/RFC9499</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9499">https://www.rfc-editor.org/info/rfc9499</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing</span></div>
<div dir="auto" class="left"><span class="org">Citrix Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">4988 Great America Pkwy</span></div>
<div dir="auto" class="left">
<span class="locality">Santa Clara</span>, <span class="region">CA</span> <span class="postal-code">95054</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:danwing@gmail.com" class="email">danwing@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kevin Smith</span></div>
<div dir="auto" class="left"><span class="org">Vodafone Group</span></div>
<div dir="auto" class="left"><span class="street-address">One Kingdom Street</span></div>
<div dir="auto" class="left"><span class="locality">London</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kevin.smith@vodafone.com" class="email">kevin.smith@vodafone.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Benjamin Schwartz</span></div>
<div dir="auto" class="left"><span class="org">Meta Platforms, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@bemasc.net" class="email">ietf@bemasc.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
